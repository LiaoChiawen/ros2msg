# ROS2 Message Definition #

This repo stores all the ROS2 message definitions. The folder structure under the `Sources/STRAPS-ros2msg` folder follows the ROS2 message definitions without the `msg` subfolder. 

`Sources/STRAPS-ros2msg/Resources` folder contains the original `.msg` files provdied by ROS2. Currently we are using the `Humble Hawksbill` distribution.

Note that the `.msg` files under the `Sources/STRAPS-ros2msg/Resources/ros2humble` folder is not the normal `.msg` file the user would expect in a normal ROS2 project. Every one of these `.msg` files contains the defintion of all its dependent message types. This is required by MCAP. The entire `ros2humble` folder is generated by the [straps_msgs_preprocess](https://github.com/strapsai/straps_msgs_preprocess) repo.

Note that currently, the Swift version of the ROS2 messages are not exhaustive. Only a subset of ROS2 images are implemented at the moment. 

# Implement a ROS2 message or add new message types #

Please create pull requests for implementing/adding new messages.

## Swift part ##
Create the fold structure that corresponds to a ROS2 message or your custom message. Add a Swift file using the name of the message as the file name. Write a new class that implement the `ROS2Message` protocal. Additionally, use the`@ROS2MsgType` macro to annotate the class definition.

The easist way to do this is copy the Swift file of a similar message and modify the content.

The supported primitive types are listed in the documentation of the [CDRCodable](https://github.com/DimaRU/CDRCodable) package.

Note: Never use `[ UInt8 ]` to represent an array of bytes. Use `Data` instead. E.g., the [Image messgae](https://github.com/strapsai/STRAPS-ros2msg/blob/8b270d485a1734811fe1ed3191c9c60b70a735eb/Sources/STRAPS-ros2msg/sensor_msgs/Image.swift#L35).

Note: Since CDRCodable does not support fixed-size arrays, they are represented by hard-coded place holders like [Covariance36](https://github.com/strapsai/STRAPS-ros2msg/blob/main/Sources/STRAPS-ros2msg/StaticArray.swift). Please refer to [PoseWithCovariance](https://github.com/strapsai/STRAPS-ros2msg/blob/main/Sources/STRAPS-ros2msg/geometry_msgs/PoseWithCovariance.swift) as an example.

For almost every new Swift file created in this repo, we need an associated Swift file to be created in [swift-ros2](https://github.com/strapsai/swift-ros2).

## ROS2 Msg part ##

Besides the folder structure and the Swift source file, for a customized ROS2 message, we also need to craete the `.msg` description file and the associated folder structure under `Sources/Resources/ros2humble` folder.

The valid ROS2 types and the associated IDL/DDS types could be found [here](https://design.ros2.org/articles/mapping_dds_types.html).

# Who to talk to? #

Yaoyu Hu: yaoyuh@andrew.cmu.edu
